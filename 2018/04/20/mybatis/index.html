<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Mybatis," />










<meta name="description" content="说明：本文由大量的源代码，及截图，建议读者，操作一遍。ide：IDEA。文末有笔记及视频分享 数据表的sql下载 密码: xjjw 1、对原生态jdbc程序（单独使用jdbc开发）问题总结先来看一部分代码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535">
<meta name="keywords" content="Mybatis">
<meta property="og:type" content="article">
<meta property="og:title" content="Mybatis学习笔记🕊">
<meta property="og:url" content="http://yoursite.com/2018/04/20/mybatis/index.html">
<meta property="og:site_name" content="EasyChill&#39;Blogs">
<meta property="og:description" content="说明：本文由大量的源代码，及截图，建议读者，操作一遍。ide：IDEA。文末有笔记及视频分享 数据表的sql下载 密码: xjjw 1、对原生态jdbc程序（单独使用jdbc开发）问题总结先来看一部分代码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://img-blog.csdn.net/20180420191152719?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180420192318329?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180420192421830?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180421194813729?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180421194952190?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/2018042120040421?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180421200413843?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180421203823427?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422184535281?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422185457670?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422191151327?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422185514111?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422190340650?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422190515638?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422190525912?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422190700191?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422190712411?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422190756669?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422190807604?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422202525550?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422202534357?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422203142431?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422203155118?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422203206632?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422205018480?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422205107494?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422205352753?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180422205223880?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/2018042419301948?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/2018042419302869?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424194937777?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424194956372?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424195023388?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424203923979?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424204153986?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424204301957?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424204327547?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424210559929?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424210645508?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424210723446?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424212749871?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424212812856?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/2018042421284048?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424212856266?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180424213406417?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180425194135238?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180425194250260?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180425194544579?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180425194356425?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180425194439135?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180429162309692?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180429174426722?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502105143436?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/2018050210531373?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502112111808?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502115222752?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502115232686?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502115327122?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502131052785?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502132013592?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502133031610?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:image" content="https://img-blog.csdn.net/20180502165235383?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:updated_time" content="2018-09-21T14:58:19.509Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mybatis学习笔记🕊">
<meta name="twitter:description" content="说明：本文由大量的源代码，及截图，建议读者，操作一遍。ide：IDEA。文末有笔记及视频分享 数据表的sql下载 密码: xjjw 1、对原生态jdbc程序（单独使用jdbc开发）问题总结先来看一部分代码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535">
<meta name="twitter:image" content="https://img-blog.csdn.net/20180420191152719?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/04/20/mybatis/"/>





  <title>Mybatis学习笔记🕊 | EasyChill'Blogs</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">EasyChill'Blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">专注而非广博</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-联系我">
          <a href="/message/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-envelope"></i> <br />
            
            联系我
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/20/mybatis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="EasyChill">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://www.qqzhi.com/uploadpic/2014-05-04/034226102.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EasyChill'Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Mybatis学习笔记🕊</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-20T14:33:34+08:00">
                2018-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><em>说明：本文由大量的源代码，及截图，建议读者，操作一遍。ide：IDEA。文末有笔记及视频分享</em></p>
<p>数据表的sql下载<a href="https://pan.baidu.com/s/16WabwxxmnPghSRw5DpCEfQ" target="_blank" rel="noopener"> 密码: xjjw</a></p>
<h2 id="1、对原生态jdbc程序（单独使用jdbc开发）问题总结"><a href="#1、对原生态jdbc程序（单独使用jdbc开发）问题总结" class="headerlink" title="1、对原生态jdbc程序（单独使用jdbc开发）问题总结"></a>1、对原生态jdbc程序（单独使用jdbc开发）问题总结</h2><p>先来看一部分代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">Public static void main(String[] args) &#123;</span><br><span class="line">			Connection connection = null;</span><br><span class="line">			PreparedStatement preparedStatement = null;</span><br><span class="line">			ResultSet resultSet = null;</span><br><span class="line">			</span><br><span class="line">			try &#123;</span><br><span class="line">				//加载数据库驱动</span><br><span class="line">				Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">				</span><br><span class="line">				//通过驱动管理类获取数据库链接</span><br><span class="line">				connection =  DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8&quot;, &quot;root&quot;, &quot;mysql&quot;);</span><br><span class="line">				//定义sql语句 ?表示占位符</span><br><span class="line">			String sql = &quot;select * from user where username = ?&quot;;</span><br><span class="line">				//获取预处理statement</span><br><span class="line">				preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">				//设置参数，第一个参数为sql语句中参数的序号（从1开始），第二个参数为设置的参数值</span><br><span class="line">				preparedStatement.setString(1, &quot;王五&quot;);</span><br><span class="line">				//向数据库发出sql执行查询，查询出结果集</span><br><span class="line">				resultSet =  preparedStatement.executeQuery();</span><br><span class="line">				//遍历查询结果集</span><br><span class="line">				while(resultSet.next())&#123;</span><br><span class="line">					System.out.println(resultSet.getString(&quot;id&quot;)+&quot;  &quot;+resultSet.getString(&quot;username&quot;));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; catch (Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;finally&#123;</span><br><span class="line">				//释放资源</span><br><span class="line">				if(resultSet!=null)&#123;</span><br><span class="line">					try &#123;</span><br><span class="line">						resultSet.close();</span><br><span class="line">					&#125; catch (SQLException e) &#123;</span><br><span class="line">						// TODO Auto-generated catch block</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				if(preparedStatement!=null)&#123;</span><br><span class="line">					try &#123;</span><br><span class="line">						preparedStatement.close();</span><br><span class="line">					&#125; catch (SQLException e) &#123;</span><br><span class="line">						// TODO Auto-generated catch block</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				if(connection!=null)&#123;</span><br><span class="line">					try &#123;</span><br><span class="line">						connection.close();</span><br><span class="line">					&#125; catch (SQLException e) &#123;</span><br><span class="line">						// TODO Auto-generated catch block</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面代码有如下几个问题：</p>
<ul>
<li>数据库连接，使用时创建，不使用就关闭，对数据库进行频繁连接开启和关闭，造成数据库资源的浪费<ul>
<li>解决：<strong>使用数据库连接池管理数据库连接</strong></li>
</ul>
</li>
<li>将sql 语句硬编码到Java代码中，如果sql语句修改，需要对java代码重新编译，不利于系统维护<ul>
<li>解决：<strong>将sql语句设置在xml配置文件中，即使sql变化，也无需重新编译</strong></li>
</ul>
</li>
<li>向preparedStatement中设置参数，对占位符位置和设置参数值，硬编码到Java文件中，不利于系统维护<ul>
<li>解决：<strong>将sql语句及占位符，参数全部配置在xml文件中</strong></li>
</ul>
</li>
<li>从resutSet中遍历结果集数据时，存在硬编码，将获取表的字段进行硬编码，不利于系统维护。<ul>
<li>解决：<strong>将查询的结果集，自动映射成java对象</strong></li>
</ul>
</li>
</ul>
<h2 id="2、Mybatis框架原理-掌握"><a href="#2、Mybatis框架原理-掌握" class="headerlink" title="2、Mybatis框架原理(掌握)"></a>2、Mybatis框架原理(掌握)</h2><ul>
<li><strong>什么是Mybatis？</strong><ul>
<li>mybatis是一个持久层的框架，是apache下的顶级项目。</li>
<li>mybatis托管到goolecode下，后来托管到github下:<a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="noopener">mybatis Github地址</a></li>
<li>mybatis让程序将主要精力放在sql上，通过mybatis提供的映射方式，自由灵活生成（半自动化，大部分需要程序员编写sql）满足需要sql语句。</li>
<li>mybatis可以将向 preparedStatement中的输入参数自动进行输入映射，将查询结果集灵活映射成java对象。（输出映射）</li>
</ul>
</li>
<li><strong>Mybatis原理图</strong>：<br><img src="https://img-blog.csdn.net/20180420191152719?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
<h2 id="3、Mybatis入门程序"><a href="#3、Mybatis入门程序" class="headerlink" title="3、Mybatis入门程序"></a>3、Mybatis入门程序</h2><ul>
<li>Mybatis和SpringMVC实现订单商品案例</li>
<li><strong>需求</strong><ul>
<li>根据用户的id查询用户信息</li>
<li>根据用户的名称模糊查询用户信息</li>
<li>添加用户</li>
<li>删除用户</li>
<li>更新用户</li>
</ul>
</li>
<li><p>Mybatis的运行环境（jar包）</p>
<ul>
<li><p>从这里点击<a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="noopener">下载</a></p>
<p>笔者下载的是：<br><img src="https://img-blog.csdn.net/20180420192318329?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>下载<strong>mybatis-3.4.6.zip</strong>解压即可<br><img src="https://img-blog.csdn.net/20180420192421830?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<ul>
<li>lib下：依赖包</li>
<li>mybatis-3.4.6.jar：核心 包</li>
<li>mybatis-3.4.6.pdf，操作指南</li>
</ul>
</li>
</ul>
<p><strong>目录结构：</strong><br><img src="https://img-blog.csdn.net/20180421194813729?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>jar包结构</strong><br><img src="https://img-blog.csdn.net/20180421194952190?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>过程中需要数据库的连接，junit的调试，注意要将jar包<strong>build path！</strong></p>
</li>
</ul>
<p><strong>log4j.properties</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Global logging configuration</span><br><span class="line"># 开发环境下，日志级别要设置成DEBUG或者ERROR</span><br><span class="line">log4j.rootLogger=DEBUG, stdout</span><br><span class="line"># Console output...</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure></p>
<p><strong>SqlMapConfig.xml</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- 和spring整合后 environments配置将废除--&gt;</span><br><span class="line">    &lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">        &lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">            &lt;!-- 使用jdbc事务管理--&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">            &lt;!-- 数据库连接池--&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot; /&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;&quot; /&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;!--加载映射文件--&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;sqlmap/User.xml&quot;/&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>User.xml</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">    命名空间，作用为，对sql进行分类化管理，理解sql隔离，</span><br><span class="line">    注意：使用mapper代理方法开发，namespace有特殊作用</span><br><span class="line">--&gt;</span><br><span class="line">&lt;mapper namespace=&quot;test&quot;&gt;</span><br><span class="line">    &lt;!--在映射文件中配置sql--&gt;</span><br><span class="line">    &lt;!--</span><br><span class="line">        findUserById</span><br><span class="line">        通过select执行数据库查询</span><br><span class="line">        id：标识映射文件的sql</span><br><span class="line">        将sql语句封装到mappedStatement对象中，所以将id称为Statement的id</span><br><span class="line">        #&#123;&#125;:表示一个占位符</span><br><span class="line">        parameterType:指定输入参数的类型</span><br><span class="line">        #&#123;id&#125;：其中的id表示接收输入的参数，参数的名称就是id，如果输入参数类型为简单类型，那么#&#123;&#125;中的参数可以任意，可以是value或其他</span><br><span class="line">        resultType：指定sql输出结果的所映射的Java对象类型，select指定的resultType表示将单条记录映射成的Java对象</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;select id=&quot;findUserById&quot; parameterType=&quot;int&quot; resultType=&quot;com.nuc.mybatis.po.User&quot;&gt;</span><br><span class="line">        select * from user where id=#&#123;VALUE &#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!--</span><br><span class="line">        findUserByName</span><br><span class="line">        $&#123;&#125;:表示拼接字符串，将接收到的sql不加任何修饰拼接在sql语句里</span><br><span class="line">        使用$&#123;&#125;拼接sql，可能会引起sql注入,一般不建议使用</span><br><span class="line">        $&#123;value&#125;：接收参数的内容，如果传入的的是简单类型，$&#123;&#125;中只能使用value</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;select id=&quot;findUserByName&quot; parameterType=&quot;java.lang.String&quot; resultType=&quot;com.nuc.mybatis.po.User&quot;&gt;</span><br><span class="line">        select * from user WHERE username LIKE &apos;%$&#123;value&#125;%&apos;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!--</span><br><span class="line">        添加用户</span><br><span class="line">        parameterType:指定参数类型为pojo类型</span><br><span class="line">        #&#123;&#125;中指定pojo的属性名，接收到的pojo对象的属性值，mybatis通过OGNL获取对象的值</span><br><span class="line">        SELECT LAST_INSERT_ID():得到刚刚insert进去的记录的主键值，只适用于主键自增</span><br><span class="line">        非主键自的则需要使用uuid()来实现,表的id类型也得设置为tring(详见下面的注释)</span><br><span class="line">        keyProperty：将查询到的主键值设置到SparameterType指定的对象的哪个属性</span><br><span class="line">        order:SELECT LAST_INSERT_ID()执行顺序，相当于insert语句来说它的实现顺序</span><br><span class="line"></span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;com.nuc.mybatis.po.User&quot;&gt;</span><br><span class="line">        &lt;!--uuid()--&gt;</span><br><span class="line">        &lt;!--</span><br><span class="line">            &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.String&quot;&gt;</span><br><span class="line">              SELECT uuid()</span><br><span class="line">            &lt;/selectKey&gt;</span><br><span class="line">            insert into user (id,username,birthday,sex,address) value(#&#123;id&#125;,#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">        --&gt;</span><br><span class="line">      &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">          SELECT LAST_INSERT_ID()</span><br><span class="line">      &lt;/selectKey&gt;</span><br><span class="line">      insert into user (username,birthday,sex,address) value(#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;delete id=&quot;deleteUser&quot; parameterType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">        delete from user where id=#&#123;id&#125;</span><br><span class="line">    &lt;/delete&gt;</span><br><span class="line"></span><br><span class="line">    &lt;update id=&quot;updateUser&quot; parameterType=&quot;com.nuc.mybatis.po.User&quot;&gt;</span><br><span class="line">        UPDATE user set username=#&#123;username&#125;,birthday=#&#123;birthday&#125;,sex=#&#123;sex&#125;,address=#&#123;address&#125; where id=#&#123;id&#125;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>User.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.po;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">public class User &#123;</span><br><span class="line">    //用户po</span><br><span class="line">    //属性名和数据库字段名对应</span><br><span class="line">    private int id;</span><br><span class="line">    private String username;// 用户姓名</span><br><span class="line">    private String sex;// 性别</span><br><span class="line">    private Date birthday;// 生日</span><br><span class="line">    private String address;// 地址</span><br><span class="line"></span><br><span class="line">    public int getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(int id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getUsername() &#123;</span><br><span class="line">        return username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUsername(String username) &#123;</span><br><span class="line">        this.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getSex() &#123;</span><br><span class="line">        return sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setSex(String sex) &#123;</span><br><span class="line">        this.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Date getBirthday() &#123;</span><br><span class="line">        return birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setBirthday(Date birthday) &#123;</span><br><span class="line">        this.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getAddress() &#123;</span><br><span class="line">        return address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAddress(String address) &#123;</span><br><span class="line">        this.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>MybatisFirst.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.first;</span><br><span class="line"></span><br><span class="line">import com.nuc.mybatis.po.User;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public class MybatisFirst &#123;</span><br><span class="line">    //根据id查询用户信息，得到一条记录</span><br><span class="line">    @Test</span><br><span class="line">    public void findUserByIdTest() throws IOException &#123;</span><br><span class="line">        //mybatis配置文件</span><br><span class="line">        String resource = &quot;SqlMapConfig.xml&quot;;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        //创建会话工厂</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        //通过工厂得到SqlSession</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        //通过SqlSession操作数据库</span><br><span class="line">        //第一个参数：映射文件中的statement的id，等于namespace+&quot;.&quot;+statement的id</span><br><span class="line">        //第二个参数：指定和映射文件中所匹配的所有parameterType的类型</span><br><span class="line">        //sqlSession.selectOne()的结果是映射文件中所匹配的resultType类型的对象</span><br><span class="line">        User user = sqlSession.selectOne(&quot;test.findUserById&quot;,1);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        //释放资源</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    //根据用户名称查询用户列表</span><br><span class="line">    @Test</span><br><span class="line">    public void findUserByName() throws IOException &#123;</span><br><span class="line">        //mybatis配置文件</span><br><span class="line">        String resource = &quot;SqlMapConfig.xml&quot;;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        //创建会话工厂</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        //通过工厂得到SqlSession</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        List&lt;User&gt; list= sqlSession.selectList(&quot;test.findUserByName&quot;,&quot;小明&quot;);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">/*</span><br><span class="line">    小结：</span><br><span class="line">    selectOne和selectList：</span><br><span class="line"></span><br><span class="line">    selectOne表示查询出一条记录进行映射。如果使用selectOne可以实现使用selectList也可以实现（list中只有一个对象）。</span><br><span class="line">    selectList表示查询出一个列表（多条记录）进行映射。如果使用selectList查询多条记录，不能使用selectOne。</span><br><span class="line">    如果使用selectOne报错：</span><br><span class="line">    org.apache.ibatis.exceptions.TooManyResultsException: Expected one result (or null) to be returned by selectOne(), but found: 4</span><br><span class="line"></span><br><span class="line"> */</span><br><span class="line">    @Test</span><br><span class="line">    public void insertUserTest() throws IOException &#123;</span><br><span class="line">        //mybatis配置文件</span><br><span class="line">        String resource = &quot;SqlMapConfig.xml&quot;;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        //创建会话工厂</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        //通过工厂得到SqlSession</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setUsername(&quot;宋江涛&quot;);</span><br><span class="line">        user.setBirthday(new Date());</span><br><span class="line">        user.setSex(&quot;男&quot;);</span><br><span class="line">        user.setAddress(&quot;山西&quot;);</span><br><span class="line">        //list中的user和映射文件User.xml中的resultType的类型一直</span><br><span class="line">        sqlSession.insert(&quot;test.insertUser&quot;,user);</span><br><span class="line">        //提交事务</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        //获取主键</span><br><span class="line">        System.out.println(user.getId());</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    //删除用户</span><br><span class="line">    @Test</span><br><span class="line">    public void deleteUserTest() throws IOException &#123;</span><br><span class="line">        //mybatis配置文件</span><br><span class="line">        String resource = &quot;SqlMapConfig.xml&quot;;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        //创建会话工厂</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        //通过工厂得到SqlSession</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        //list中的user和映射文件User.xml中的resultType的类型一直</span><br><span class="line">        sqlSession.delete(&quot;test.deleteUser&quot;,30);</span><br><span class="line">        //提交事务</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //更新用户</span><br><span class="line">    @Test</span><br><span class="line">    public void updateUserTest() throws IOException &#123;</span><br><span class="line">        //mybatis配置文件</span><br><span class="line">        String resource = &quot;SqlMapConfig.xml&quot;;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        //创建会话工厂</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        //通过工厂得到SqlSession</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setId(27);</span><br><span class="line">        user.setUsername(&quot;宋江涛new2&quot;);</span><br><span class="line">        user.setBirthday(new Date());</span><br><span class="line">        user.setSex(&quot;男&quot;);</span><br><span class="line">        user.setAddress(&quot;山西太原new&quot;);</span><br><span class="line">        //list中的user和映射文件User.xml中的resultType的类型一直</span><br><span class="line">        sqlSession.update(&quot;test.updateUser&quot;,user);</span><br><span class="line">        //提交事务</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>数据库的设计图</strong><br><img src="https://img-blog.csdn.net/2018042120040421?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/20180421200413843?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>部分测试结果</strong><br><img src="https://img-blog.csdn.net/20180421203823427?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>jdbc的测试程序，前面已经沾过。</strong><br><strong>重点内容在代码的注释中均已说明</strong></p>
<p><strong>mybatis和hibernate本质区别和应用场景</strong></p>
<ul>
<li><p>hibernate：是一个标准ORM框架（对象关系映射）。入门门槛较高的，不需要程序写sql，sql语句自动生成了。<br>对sql语句进行优化、修改比较困难的。</p>
<ul>
<li>应用场景：<ul>
<li>适用与需求变化不多的中小型项目，比如：后台管理系统，erp、orm、oa。。</li>
</ul>
</li>
</ul>
</li>
<li><p>mybatis：专注是sql本身，需要程序员自己编写sql语句，sql修改、优化比较方便。mybatis是一个不完全 的ORM框架，虽然程序员自己写sql，mybatis 也可以实现映射（输入映射、输出映射）。</p>
<ul>
<li>应用场景：<ul>
<li>适用与需求变化较多的项目，比如：互联网项目。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>企业进行技术选型，以低成本 高回报作为技术选型的原则，根据项目组的技术力量进行选择。</strong></p>
<h2 id="4、Mybatis开发dao的方法"><a href="#4、Mybatis开发dao的方法" class="headerlink" title="4、Mybatis开发dao的方法"></a>4、Mybatis开发dao的方法</h2><ul>
<li><p><strong>原始dao开发方法（程序需要编写dao接口和dao实现类）(掌握)</strong></p>
<ul>
<li>在原有项目的基础上，<strong>src目录下创建com.nuc.mybatis.dao</strong></li>
<li>在这个包里有两个文件，一个是<strong>UserDao.java</strong>，另一个是<strong>UserDaoImpl.java</strong>这个类继承接口<strong>UserDao.java</strong></li>
<li>在创建一个和src同级的文件夹（记的把它标记为sources）具体方法见<a href="https://blog.csdn.net/song_jiangtao/article/details/80030243" target="_blank" rel="noopener">详情</a></li>
<li><p>在test下创建<strong>com.nuc.mybatis.test</strong>，创建类<strong>UserDaoImplTest.java</strong></p>
<p><strong>具体目录结构：</strong><br><img src="https://img-blog.csdn.net/20180422184535281?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>结构中的相关mapper请先忽略</strong></p>
</li>
</ul>
</li>
</ul>
<p><strong>UserDao.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.dao;</span><br><span class="line"></span><br><span class="line">import com.nuc.mybatis.po.User;</span><br><span class="line"></span><br><span class="line">public interface UserDao &#123;</span><br><span class="line">    //dao原始开发</span><br><span class="line">    //根据id查询用户信息</span><br><span class="line">    public User findUserById(int id) throws Exception;</span><br><span class="line">    //添加用户</span><br><span class="line">    public void insertUser(User user) throws Exception;</span><br><span class="line">    //删除用户</span><br><span class="line">    public void deleteUser(int id) throws Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>UserDaoImpl.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.dao;</span><br><span class="line"></span><br><span class="line">import com.nuc.mybatis.po.User;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line"></span><br><span class="line">public class UserDaoImpl implements UserDao &#123;</span><br><span class="line">    //原生态的dao</span><br><span class="line">    //需要向dao实现类里注入SqlSessionFactory</span><br><span class="line">    //通过构造方法</span><br><span class="line">    private SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    public UserDaoImpl(SqlSessionFactory sqlSessionFactory)&#123;</span><br><span class="line">        this.sqlSessionFactory=sqlSessionFactory;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public User findUserById(int id) throws Exception &#123;</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        User user = sqlSession.selectOne(&quot;test.findUserById&quot;,id);</span><br><span class="line">        sqlSession.close();</span><br><span class="line">        return user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void insertUser(User user) throws Exception &#123;</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        sqlSession.insert(&quot;test.insertUser&quot;,user);</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void deleteUser(int id) throws Exception &#123;</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        sqlSession.insert(&quot;test.deleteUser&quot;,id);</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>UserDaoImplTest.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.test;</span><br><span class="line"></span><br><span class="line">import com.nuc.mybatis.mapper.UserMapper;</span><br><span class="line">import com.nuc.mybatis.po.User;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">import org.junit.Before;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public class UserMapperTest &#123;</span><br><span class="line">    //原始dao的测试</span><br><span class="line">    private SqlSessionFactory sqlSessionFactory;</span><br><span class="line">    @Before</span><br><span class="line">    public void setUp() throws Exception&#123;</span><br><span class="line">        String resource = &quot;SqlMapConfig.xml&quot;;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        //创建会话工厂</span><br><span class="line">        sqlSessionFactory = new</span><br><span class="line">                SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">    &#125;</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindUserById() throws Exception&#123;</span><br><span class="line">      SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">       //创建UserMapper的对象,mybatis自动调用</span><br><span class="line">        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        User user = userMapper.findUserById(1);</span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindUserByName() throws Exception&#123;</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        //创建UserMapper的对象,mybatis自动调用</span><br><span class="line">        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        List&lt;User&gt; list= userMapper.findUserByName(&quot;宋江涛&quot;);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">    //其他的测试，可以照猫画虎</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>测试结果：</strong><br><img src="https://img-blog.csdn.net/20180422185457670?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<ul>
<li><p><strong>Mybatis的mapper接口（相当于dao接口）代理开发方法(掌握)</strong></p>
<p>  <strong>根据上面的结构图创建相应文件，源码如下：</strong></p>
</li>
</ul>
<p><strong>UserMapper.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.mapper;</span><br><span class="line"></span><br><span class="line">import com.nuc.mybatis.po.User;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public interface UserMapper &#123;</span><br><span class="line">    //mapper代理开发和dao开发对比</span><br><span class="line">//    mapper接口,相当于dao接口，mybatis可以自动生成mapper接口实现类的代理对象</span><br><span class="line">    //根据id查询用户信息</span><br><span class="line">    public User findUserById(int id) throws Exception;</span><br><span class="line">    //根据用户名查询用户列表</span><br><span class="line">    public List&lt;User&gt;findUserByName(String name) throws Exception;</span><br><span class="line">    //添加用户</span><br><span class="line">    public void insertUser(User user) throws Exception;</span><br><span class="line">    //删除用户</span><br><span class="line">    public void deleteUser(int id) throws Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>UserMapper.xml</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.nuc.mybatis.mapper.UserMapper&quot;&gt;</span><br><span class="line">    &lt;select id=&quot;findUserById&quot; parameterType=&quot;int&quot; resultType=&quot;com.nuc.mybatis.po.User&quot;&gt;</span><br><span class="line">        select * from user where id=#&#123;VALUE &#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">    &lt;select id=&quot;findUserByName&quot; parameterType=&quot;java.lang.String&quot; resultType=&quot;com.nuc.mybatis.po.User&quot;&gt;</span><br><span class="line">        select * from user WHERE username LIKE &apos;%$&#123;value&#125;%&apos;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;com.nuc.mybatis.po.User&quot;&gt;</span><br><span class="line">     </span><br><span class="line">      &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">          SELECT LAST_INSERT_ID()</span><br><span class="line">      &lt;/selectKey&gt;</span><br><span class="line">      insert into user (username,birthday,sex,address) value(#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;delete id=&quot;deleteUser&quot; parameterType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">        delete from user where id=#&#123;id&#125;</span><br><span class="line">    &lt;/delete&gt;</span><br><span class="line"></span><br><span class="line">    &lt;update id=&quot;updateUser&quot; parameterType=&quot;com.nuc.mybatis.po.User&quot;&gt;</span><br><span class="line">        UPDATE user set username=#&#123;username&#125;,birthday=#&#123;birthday&#125;,sex=#&#123;sex&#125;,address=#&#123;address&#125; where id=#&#123;id&#125;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>在测试之前需要在SqlMapConfig.xml中加载mapper.xml这个映射文件</strong><br><img src="https://img-blog.csdn.net/20180422191151327?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>UserMapperTest.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.test;</span><br><span class="line"></span><br><span class="line">import com.nuc.mybatis.mapper.UserMapper;</span><br><span class="line">import com.nuc.mybatis.po.User;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">import org.junit.Before;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public class UserMapperTest &#123;</span><br><span class="line">    //原始mapper的测试</span><br><span class="line">    private SqlSessionFactory sqlSessionFactory;</span><br><span class="line">    @Before</span><br><span class="line">    public void setUp() throws Exception&#123;</span><br><span class="line">        String resource = &quot;SqlMapConfig.xml&quot;;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        //创建会话工厂</span><br><span class="line">        sqlSessionFactory = new</span><br><span class="line">                SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">    &#125;</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindUserById() throws Exception&#123;</span><br><span class="line">      SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">       //创建UserMapper的对象,mybatis自动调用</span><br><span class="line">        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        User user = userMapper.findUserById(1);</span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindUserByName() throws Exception&#123;</span><br><span class="line">    //返回列表测试</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        //创建UserMapper的对象,mybatis自动调用</span><br><span class="line">        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        List&lt;User&gt; list= userMapper.findUserByName(&quot;宋江涛&quot;);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>部分测试结果：</strong><br><img src="https://img-blog.csdn.net/20180422185514111?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>总结：</strong></p>
<ul>
<li><strong>原始dao开发问题</strong><ul>
<li>dao接口实现类方法中存在大量模板方法，设想能否将这些代码提取出来，大大减轻程序员的工作量。</li>
<li>调用sqlsession方法时将statement的id硬编码了</li>
</ul>
</li>
<li><p><strong>mapper开发</strong></p>
<ul>
<li>只需要编写两个文件，mapper.java,mapper.xml。即可，不需要类来继承它。</li>
<li><p>mapper开发只需要遵守几个规范即可</p>
<ul>
<li><strong>在mapper.xml中namespace等于mapper接口地址</strong><br><img src="https://img-blog.csdn.net/20180422190340650?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li><strong>mapper.java接口中的方法名和mapper.xml中statement的id一致</strong><br><img src="https://img-blog.csdn.net/20180422190515638?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/20180422190525912?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li><strong>mapper.java接口中的方法输入参数类型和mapper.xml中statement的parameterType指定的类型一致。</strong><br><img src="https://img-blog.csdn.net/20180422190700191?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/20180422190712411?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li><strong>mapper.java接口中的方法返回值类型和mapper.xml中statement的resultType指定的类型一致。</strong><br><img src="https://img-blog.csdn.net/20180422190756669?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/20180422190807604?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
<li><p>其实，以上开发规范主要是对下边的代码<strong>进行统一生成：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User user = sqlSession.selectOne(&quot;test.findUserById&quot;, id);</span><br><span class="line">sqlSession.insert(&quot;test.insertUser&quot;, user);</span><br><span class="line">。。。。</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>mapper接口方法参数只能有一个是否影响系统 开发？mapper接口方法参数只能有一个，系统是否不利于扩展维护？</strong></p>
<ul>
<li>系统 框架中，dao层的代码是被业务层公用的。</li>
<li>即使mapper接口只有一个参数，可以使用包装类型的pojo满足不同的业务方法的需求。</li>
</ul>
<p><strong>注意：持久层方法的参数可以包装类型、map。。。，service方法中建议不要使用包装类型（不利于业务层的可扩展）。</strong></p>
</li>
</ul>
</li>
</ul>
<h2 id="5、Mybatis配置文件SqlMapConfig-xml"><a href="#5、Mybatis配置文件SqlMapConfig-xml" class="headerlink" title="5、Mybatis配置文件SqlMapConfig.xml"></a>5、Mybatis配置文件SqlMapConfig.xml</h2><ul>
<li><p>properties（属性）</p>
<ul>
<li>将数据库连接的参数单独配置在，db.properties中，只需要在SqlMapConfig.xml中加载db.properties的属性值。在SqlMapConfig.xml中就不需要对数据库连接参数硬编码。</li>
<li><strong>好处：</strong>方便对参数进行统一管理，其它xml可以引用该db.properties</li>
<li><p><strong>特性：</strong> MyBatis 将按照下面的顺序来加载属性：</p>
<ul>
<li>在 properties 元素体内定义的属性首先被读取。 </li>
<li>然后会读取properties 元素中resource或 url 加载的属性，它会覆盖已读取的同名属性。 </li>
<li><p>最后读取parameterType传递的属性，它会覆盖已读取的同名属性。</p>
<p><strong>建议：</strong></p>
<ul>
<li>不要在properties元素体内添加任何属性值，只将属性值定义在properties文件中。</li>
<li>在properties文件中定义属性名要有一定的特殊性，如XXXXX.XXXXX.XXXX<br><img src="https://img-blog.csdn.net/20180422202525550?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/20180422202534357?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>settings（全局配置参数）<ul>
<li>mybatis框架在运行时可以调整一些运行参数。比如：开启二级缓存、开启延迟加载。。<strong>全局参数将会影响mybatis的运行行为。具体如下：</strong><br><img src="https://img-blog.csdn.net/20180422203142431?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/20180422203155118?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/20180422203206632?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
<li>typeAliases（类型别名）(<strong>重点</strong>)<ul>
<li>单个定义<br><img src="https://img-blog.csdn.net/20180422205018480?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>批量定义（常用）<br><img src="https://img-blog.csdn.net/20180422205107494?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>这样在其他地方就可以使用，例如：<br><img src="https://img-blog.csdn.net/20180422205352753?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>mybatis默认支持的别名<br><img src="https://img-blog.csdn.net/20180422205223880?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
<li>typeHandlers（类型处理器）<ul>
<li>mybatis中通过typeHandlers完成jdbc类型和java类型的转换。通常情况下，mybatis提供的类型处理器满足日常需要，不需要自定义.</li>
<li>mybatis支持的类型处理器<br><img src="https://img-blog.csdn.net/2018042419301948?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/2018042419302869?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
<li>objectFactory（对象工厂）<ul>
<li>这个自行查看下载mybatis时附带的pdf文件，用的不多</li>
</ul>
</li>
<li>plugins（插件）</li>
<li>environments（环境集合属性对象）<ul>
<li>environment（环境子属性对象）<ul>
<li>transactionManager（事务管理）</li>
<li>dataSource（数据源）</li>
</ul>
</li>
</ul>
</li>
<li>mappers（映射器）<ul>
<li>通过resource<br><img src="https://img-blog.csdn.net/20180424194937777?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>通过class<br><img src="https://img-blog.csdn.net/20180424194956372?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>通过package(推荐使用)<br><img src="https://img-blog.csdn.net/20180424195023388?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
</ul>
<h2 id="6、Mybatis核心"><a href="#6、Mybatis核心" class="headerlink" title="6、Mybatis核心"></a>6、Mybatis核心</h2><ul>
<li><p><strong>Mybatis输入映射（掌握）</strong></p>
<ul>
<li>通过parameterType指定输入参数的类型，类型可以是简单类型、hashmap、pojo的包装类型<ul>
<li>传递pojo的包装对象<ul>
<li><strong>需求：</strong>完成用户信息的综合查询，需要传入查询条件很复杂（可能包括用户信息、其它信息，比如商品、订单的）</li>
<li>针对上边需求，建议使用自定义的包装类型的pojo。<br>在包装类型的pojo中将复杂的查询条件包装进去。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>目录结构</strong><br><img src="https://img-blog.csdn.net/20180424203923979?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>UserCustom.java</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.po;</span><br><span class="line"></span><br><span class="line">public class UserCustom extends User &#123;</span><br><span class="line">    //可扩展用户信息</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>UserQueryVo.java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package com.nuc.mybatis.po;</span><br><span class="line"></span><br><span class="line">public class UserQueryVo &#123;</span><br><span class="line">    //这里包装所需的查询条件</span><br><span class="line"></span><br><span class="line">    //用户查询条件</span><br><span class="line">    private UserCustom userCustom;</span><br><span class="line"></span><br><span class="line">    public UserCustom getUserCustom() &#123;</span><br><span class="line">        return userCustom;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUserCustom(UserCustom userCustom) &#123;</span><br><span class="line">        this.userCustom = userCustom;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //可包装其他的查询条件，订单，商品。。。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>UserMapper.xml中配置新的查询</strong><br><img src="https://img-blog.csdn.net/20180424204153986?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>UserMapperTest.java中新增测试</strong><br><img src="https://img-blog.csdn.net/20180424204301957?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>测试结果</strong><br><img src="https://img-blog.csdn.net/20180424204327547?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<ul>
<li><p><strong>Mybatis输出映射（掌握）</strong></p>
<ul>
<li><p><strong>一、resultType</strong></p>
<ul>
<li><strong>使用resultType进行输出映射，只有查询出来的列名和pojo中的属性名一致，该列才可以映射成功。</strong></li>
<li>如果查询出来的列名和pojo中的属性名全部不一致，没有创建pojo对象。</li>
<li>只要查询出来的列名和pojo中的属性有一个一致，就会创建pojo对象</li>
</ul>
<p><strong>在上面的输入中，属于每一列都成功映射</strong><br><img src="https://img-blog.csdn.net/20180424210559929?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>当我们修改查询语句为：</strong><br><img src="https://img-blog.csdn.net/20180424210645508?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>其中id，起了别名叫做id_<br><strong>测试结果：</strong><br><img src="https://img-blog.csdn.net/20180424210723446?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>很明显，由于查询条件，生日和地址为空，由于id的映射失败，导致查询id失败，只有sex一列映射成功，故查询成功（1代表男，2代表女）</p>
</li>
<li><strong>1.resultType的输出简单类型</strong><ul>
<li><strong>需求：</strong>用户信息的综合查询列表总数，通过查询总数和上边用户综合查询列表才可以实现分页。 </li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>如法炮制</strong>，对mapper.xml编辑和mapper.java编辑<br>         <img src="https://img-blog.csdn.net/20180424212749871?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>         <img src="https://img-blog.csdn.net/20180424212812856?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>         <strong>测试代码(复制修改)</strong><br>         <img src="https://img-blog.csdn.net/2018042421284048?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>         <strong>测试结果</strong><br>         <img src="https://img-blog.csdn.net/20180424212856266?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>         <strong>总结：查询出来的结果集只有一行且一列，可以使用简单类型进行输出映射。</strong></p>
<ul>
<li><p><strong>2.resultType的输出pojo对象和pojo列表</strong></p>
<ul>
<li><strong>不管是输出的pojo单个对象还是一个列表（list中包括pojo），在mapper.xml中resultType指定的类型是一样的。</strong><ul>
<li>在mapper.java指定的方法返回值类型不一样：<ul>
<li>1、输出单个pojo对象，方法返回值是单个对象类型</li>
<li>2、输出pojo对象list，方法返回值是List&lt;简单java对象&gt;<br><img src="https://img-blog.csdn.net/20180424213406417?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>二、resultMap</strong></p>
<ul>
<li>mybatis中使用resultMap完成高级输出结果映射。</li>
<li>实例：<ul>
<li>1、在usermapper.xml定义resultMap<br><img src="https://img-blog.csdn.net/20180425194135238?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>2、在usermapper.xml中定义查询<br><img src="https://img-blog.csdn.net/20180425194250260?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>3、在usermapper.java中定义方法<br><img src="https://img-blog.csdn.net/20180425194544579?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>4、编写测试方法<br><img src="https://img-blog.csdn.net/20180425194356425?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>5、测试结果<br><img src="https://img-blog.csdn.net/20180425194439135?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li><strong>6、总结</strong><ul>
<li><strong>使用resultType进行输出映射，只有查询出来的列名和pojo中的属性名一致，该列才可以映射成功</strong>。</li>
<li><strong>如果查询出来的列名和pojo的属性名不一致，通过定义一个resultMap对列名和pojo属性名之间作一个映射关系。</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="7、Mybatis的动态sql-掌握"><a href="#7、Mybatis的动态sql-掌握" class="headerlink" title="7、Mybatis的动态sql(掌握)"></a>7、Mybatis的动态sql(掌握)</h2><ul>
<li>什么是动态sql？<ul>
<li>mybatis核心 对sql语句进行灵活操作，通过表达式进行判断，对sql进行灵活拼接、组装。</li>
<li>在原来的usermapper.xml中修改<strong>用户综合查询总数</strong>为下面代码<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">	 &lt;!--用户综合查询总数--&gt;</span><br><span class="line">    &lt;select id=&quot;findUserCount&quot; parameterType=&quot;com.nuc.mybatis.po.UserQueryVo&quot;</span><br><span class="line">            resultType=&quot;int&quot;&gt;</span><br><span class="line">        select count(*) from user</span><br><span class="line">        &lt;!--where可以自动去掉第一个and--&gt;</span><br><span class="line">        &lt;where&gt;</span><br><span class="line">            &lt;if test=&quot;userCustom!=null&quot;&gt;</span><br><span class="line">                &lt;if test=&quot;userCustom.sex!=null and userCustom.sex!=&apos;&apos;&quot;&gt;</span><br><span class="line">                    and user.sex=#&#123;userCustom.sex&#125;</span><br><span class="line">                &lt;/if&gt;</span><br><span class="line">                &lt;if test=&quot;userCustom.username!=null and userCustom.username!=&apos;&apos;&quot;&gt;</span><br><span class="line">                    and user.username=#&#123;userCustom.username&#125;</span><br><span class="line">                &lt;/if&gt;</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">        &lt;/where&gt;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">```	 </span><br><span class="line"> </span><br><span class="line">   - 修改测试类及测试结果</span><br><span class="line">   ![这里写图片描述](https://img-blog.csdn.net/20180425200925731?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)</span><br><span class="line">   - **sql片段**</span><br><span class="line">	   - 将上边实现的动态sql判断代码块抽取出来，组成一个sql片段。其它的statement中就可以引用sql片段。方便程序员进行开发</span><br><span class="line">	   - 先在mapper.xml中定义一个sql片段</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<!--sql片段
    经验：基于单表来定义sql片段，这样，sql片段的可重用度就高
    在sql片段中不要用where，因为你很有可能查询条件不止一个
    -->
<pre><code>&lt;sql id=&quot;Query_user&quot;&gt;
    &lt;if test=&quot;userCustom!=null&quot;&gt;
        &lt;if test=&quot;userCustom.sex!=null and userCustom.sex!=&apos;&apos;&quot;&gt;
            and user.sex=#{userCustom.sex}
        &lt;/if&gt;
        &lt;if test=&quot;userCustom.username!=null and userCustom.username!=&apos;&apos;&quot;&gt;
            and user.username=#{userCustom.username}
        &lt;/if&gt;
    &lt;/if&gt;
&lt;/sql&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 将之前的sql语句修改如下：</span><br></pre></td></tr></table></figure>
<!--用户综合查询总数-->
<pre><code>&lt;select id=&quot;findUserCount&quot; parameterType=&quot;com.nuc.mybatis.po.UserQueryVo&quot;
        resultType=&quot;int&quot;&gt;
    select count(*) from user
    &lt;!--where可以自动去掉第一个and--&gt;
    &lt;where&gt;
        &lt;!--引用sql的id，如果refid引用的sql的id不在本mapper中，则需要家其他mapper的namespace--&gt;
        &lt;include refid=&quot;Query_user&quot;/&gt;
    &lt;/where&gt;
&lt;/select&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 测试和之前的一样 </span><br><span class="line">- **foreach**</span><br><span class="line">	- 向sql传递数组或List，mybatis使用foreach解析</span><br><span class="line">	- 在用户查询列表和查询总数的statement中增加多个id输入查询。即实现**SELECT * FROM USER WHERE id=1 OR id=10 OR id=16**</span><br><span class="line">	- 先修改sql</span><br></pre></td></tr></table></figure>
<p><sql id="Query_user"><br>        <if test="userCustom!=null"><br>            <if test="userCustom.sex!=null and userCustom.sex!=''"><br>                and user.sex=#{userCustom.sex}<br>            </if><br>            <if test="userCustom.username!=null and userCustom.username!=''"><br>                and user.username=#{userCustom.username}<br>            </if><br>        </if><br>        <if test="ids!=null"><br>            <!--
                collection:指定输入对象集合中的属性
                item：每次遍历生成的对象名
                open：开始遍历拼接的串
                close：结束时拼接的串
                separator：每个对象的中间拼接的串
                我们要实现 and(id=1 OR id=10 OR id=16)
            --><br>            <foreach collection="ids" item="user_id" open="and(" close=")" separator="OR"><br>              <!--每次遍历拼接的串--><br>                id=#{user_id}<br>            </foreach><br>        </if><br>    </sql><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 添加属性，及其get set 方法</span><br><span class="line">![这里写图片描述](https://img-blog.csdn.net/20180425210223554?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)</span><br><span class="line">- 修改测试类</span><br></pre></td></tr></table></figure></p>
<p>//    用户综合查询总数<br>@Test<br>    public void testFindUser() throws Exception{<br>        SqlSession sqlSession = sqlSessionFactory.openSession();<br>        //创建UserMapper的对象,mybatisCount自动调用<br>        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);<br>        //创建包对象，设置查询条件<br>        UserQueryVo userQueryVo = new UserQueryVo();<br>        UserCustom userCustom = new UserCustom();<br>//        由于这里使用动态sql所以不设置某个值，就不会拼接在sql语句中<br>//        userCustom.setSex(“1”);<br>        userCustom.setUsername(“小明”);<br>        List<integer> list = new ArrayList&lt;&gt;();<br>        list.add(1);<br>        list.add(10);<br>        list.add(16);<br>        userQueryVo.setIds(list);<br>        userQueryVo.setUserCustom(userCustom);<br>        int count= userMapper.findUserCount(userQueryVo);<br>        System.out.println(count);<br>    }<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"> - 测试结果</span><br><span class="line"> ![这里写图片描述](https://img-blog.csdn.net/2018042521031361?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)</span><br><span class="line"> sql语句成功修改！</span><br><span class="line"></span><br><span class="line">## 8、订单商品数据模型分析</span><br><span class="line">- **数据模型分析思路**</span><br><span class="line">	- **1、每张表记录的数据内容**</span><br><span class="line">		- 分模块对每张表记录的内容进行熟悉，相当 于你学习系统 需求（功能）的过程</span><br><span class="line">	- **2、每张表重要的字段设置**</span><br><span class="line">		- 非空字段、外键字段</span><br><span class="line"> - **3、数据库级别表与表之间的关系**</span><br><span class="line">	 - 外键关系</span><br><span class="line"> - **4、表与表之间的业务关系**</span><br><span class="line">	 - 在分析表与表之间的业务关系时一定要建立 **在某个业务意义基础上去分析。**</span><br><span class="line">	 </span><br><span class="line">	下来拿之前的数据库的表为例，具体字段不作说明</span><br><span class="line">	![这里写图片描述](https://img-blog.csdn.net/20180426195542490?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)</span><br><span class="line">	根据上面的步骤。</span><br><span class="line">	**第一步：每张表记录的数据内容**</span><br><span class="line">	- 用户表user：记录了购买商品的用户信息</span><br><span class="line">	- 订单表：orders：记录了用户所创建的订单（购买商品的订单）</span><br><span class="line">	- 订单明细表：orderdetail：记录了订单的详细信息即购买商品的信息</span><br><span class="line">	- 商品表：items：记录了商品信息</span><br><span class="line">   </span><br><span class="line">   **第二步：每张表重要的字段设置**</span><br><span class="line">   **第三步：数据库级别表与表之间的关系**</span><br><span class="line">   - 表与表之间的业务关系：在分析表与表之间的业务关系时需要建立 **在某个业务意义基础上去分析。**</span><br><span class="line">  </span><br><span class="line">  先分析数据库级别之间有关系的表之间的业务关系：</span><br><span class="line">	- usre和orders：</span><br><span class="line">		- user---&gt;orders：一个用户可以创建多个订单，一对多</span><br><span class="line">		- orders---&gt;user：一个订单只由一个用户创建，一对一</span><br><span class="line"></span><br><span class="line">	- orders和orderdetail：</span><br><span class="line">		- orders---&gt;orderdetail：一个订单可以包括 多个订单明细，因为一个订单可以购买多个商品，每个商品的购买信息在orderdetail记录，一对多</span><br><span class="line">		- orderdetail---&gt; orders：一个订单明细只能包括在一个订单中，一对一</span><br><span class="line">	- orderdetail和itesm：</span><br><span class="line">		- orderdetail---&gt;itesms：一个订单明细只对应一个商品信息，一对一</span><br><span class="line">		- items--&gt; orderdetail:一个商品可以包括在多个订单明细 ，一对多</span><br><span class="line"></span><br><span class="line"> **第四步：表与表之间的业务关系**</span><br><span class="line"> - 再分析数据库级别没有关系的表之间是否有业务关系：</span><br><span class="line">		- orders和items：</span><br><span class="line">			- orders和items之间可以通过orderdetail表建立 关系。</span><br><span class="line">	</span><br><span class="line">	![这里写图片描述](https://img-blog.csdn.net/20180426200315989?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)</span><br><span class="line"></span><br><span class="line">## 9、高级结果集映射</span><br><span class="line"> - 一对一</span><br><span class="line"> **需求：查询订单信息，关联查询创建订单的用户信息**</span><br><span class="line"></span><br><span class="line"> **分析：**</span><br><span class="line">	 - 确定查询的主表：订单表</span><br><span class="line">	 - 确定查询的关联表：用户表</span><br><span class="line">	 - 关联查询使用内链接？还是外链接？</span><br><span class="line">	 - 由于orders表中有一个外键（user_id），通过外键关联查询用户表只能查询出一条记录，可以使用内链接。</span><br><span class="line">		</span><br><span class="line">		SELECT </span><br><span class="line">		  orders.*,</span><br><span class="line">		  USER.username,</span><br><span class="line">		  USER.sex,</span><br><span class="line">		  USER.address </span><br><span class="line">		FROM</span><br><span class="line">		  orders,</span><br><span class="line">		  USER </span><br><span class="line">		WHERE orders.user_id = user.id</span><br><span class="line">	 - 1、用**resultType**实现</span><br><span class="line">		 - 在po包中创建：Orders类</span><br><span class="line">		 - 在po包中创建：OrdersCustom类继承 Orders类</span><br><span class="line">		 - 在mapper包中创建：OrdersMapperCustom接口</span><br><span class="line">		 - 在mapper包中创建：OrdersMapperCustom.xml</span><br><span class="line">		 - 在test包中创建：OrdersMapperTest类</span><br><span class="line"></span><br><span class="line">**Orders.java**</span><br></pre></td></tr></table></figure></integer></p>
<p>package com.nuc.mybatis.po;</p>
<p>import java.util.Date;<br>import java.util.List;</p>
<p>public class Orders {<br>    private Integer id;</p>
<pre><code>private Integer userId;

private String number;

private Date createtime;

private String note;

//用户信息
private User user;

//订单明细
private List&lt;Orderdetail&gt; orderdetails;

public Integer getId() {
    return id;
}

public void setId(Integer id) {
    this.id = id;
}

public Integer getUserId() {
    return userId;
}

public void setUserId(Integer userId) {
    this.userId = userId;
}

public String getNumber() {
    return number;
}

public void setNumber(String number) {
    this.number = number == null ? null : number.trim();
}

public Date getCreatetime() {
    return createtime;
}

public void setCreatetime(Date createtime) {
    this.createtime = createtime;
}

public String getNote() {
    return note;
}

public void setNote(String note) {
    this.note = note == null ? null : note.trim();
}

public User getUser() {
    return user;
}

public void setUser(User user) {
    this.user = user;
}

public List&lt;Orderdetail&gt; getOrderdetails() {
    return orderdetails;
}

public void setOrderdetails(List&lt;Orderdetail&gt; orderdetails) {
    this.orderdetails = orderdetails;
}    
</code></pre><p>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**OrdersCustom .java**</span><br></pre></td></tr></table></figure></p>
<p>package com.nuc.mybatis.po;</p>
<p>public class OrdersCustom extends Orders {<br>    private String username;<br>    private String sex;<br>    private String address;<br>    public String getUsername() {<br>        return username;<br>    }<br>    public void setUsername(String username) {<br>        this.username = username;<br>    }<br>    public String getSex() {<br>        return sex;<br>    }<br>    public void setSex(String sex) {<br>        this.sex = sex;<br>    }<br>    public String getAddress() {<br>        return address;<br>    }<br>    public void setAddress(String address) {<br>        this.address = address;<br>    }</p>
<p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**OrdersMapperCustom.java**</span><br></pre></td></tr></table></figure>
<p>package com.nuc.mybatis.mapper;</p>
<p>import java.util.List;</p>
<p>public interface OrdersMapperCustom {<br>    public List<ordersmappercustom> findOrdersUser()throws Exception;<br>}</ordersmappercustom></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**OrdersMapperCustom .xml**</span><br></pre></td></tr></table></figure>
<p>&lt;?xml version=”1.0” encoding=”UTF-8” ?&gt;<br>&lt;!DOCTYPE mapper<br>        PUBLIC “-//mybatis.org//DTD Mapper 3.0//EN”<br>        “<a href="http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;" target="_blank" rel="noopener">http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</a></p>
<mapper namespace="com.nuc.mybatis.mapper.OrdersMapperCustom"><br>    <!--resultType:返回值的映射的pojo对象--><br>    <select id="findOrdersUser" resulttype="com.nuc.mybatis.po.OrdersCustom"><br>      SELECT<br>      orders.*,<br>      user.username,<br>      user.sex,<br>      user.address<br>      FROM<br>      orders,<br>      user<br>      WHERE orders.user_id = user.id<br>    </select><br><br></mapper>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**OrdersMapperTest.java**</span><br></pre></td></tr></table></figure>
<p>package com.nuc.mybatis.test;</p>
<p>import com.nuc.mybatis.mapper.OrdersMapperCustom;<br>import org.apache.ibatis.io.Resources;<br>import org.apache.ibatis.session.SqlSession;<br>import org.apache.ibatis.session.SqlSessionFactory;<br>import org.apache.ibatis.session.SqlSessionFactoryBuilder;<br>import org.junit.Before;<br>import org.junit.Test;</p>
<p>import java.io.InputStream;<br>import java.util.List;</p>
<p>public class OrdersMapperTest {<br>    private SqlSessionFactory sqlSessionFactory;<br>    @Before<br>    public void setUp() throws Exception{<br>        String resource = “SqlMapConfig.xml”;<br>        InputStream inputStream = Resources.getResourceAsStream(resource);<br>        //创建会话工厂<br>        sqlSessionFactory = new<br>                SqlSessionFactoryBuilder().build(inputStream);<br>    }<br>    @Test<br>    public void testFindOrdersUser() throws Exception {<br>        SqlSession sqlSession = sqlSessionFactory.openSession();<br>        // 创建代理对象<br>        OrdersMapperCustom ordersMapperCustom = sqlSession<br>                .getMapper(OrdersMapperCustom.class);<br>        // 调用maper的方法<br>        List<ordersmappercustom> list = ordersMapperCustom.findOrdersUser();<br>        System.out.println(list);<br>        sqlSession.close();<br>    }<br>}</ordersmappercustom></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">**测试结果**</span><br><span class="line">![这里写图片描述](https://img-blog.csdn.net/20180426212950456?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)</span><br><span class="line"></span><br><span class="line"> - 2、用**resultMap**实现</span><br><span class="line">	 - 实现思路：使用resultMap将查询结果中的订单信息映射到Orders对象中，在orders类中添加User属性，将关联查询出来的用户信息映射到orders对象中的user属性中。</span><br><span class="line">	  - 第一步：Orders类中添加User 的user属性。上面的代码已经添加</span><br><span class="line">	  - 第二步：mapper.xml中定义ResultMap及其查询</span><br><span class="line">	  - 第三步：接口中定义相应的方法</span><br><span class="line">	  - 最后测试</span><br><span class="line"></span><br><span class="line">**第三步：**</span><br></pre></td></tr></table></figure>
<p><resultmap type="com.nuc.mybatis.po.Orders" id="OrdersUserResultMap"><br>        <!-- 配置映射的订单信息 --><br>        <!-- id：指定查询列中的唯 一标识，订单信息的中的唯 一标识，如果有多个列组成唯一标识，配置多个id
            column：订单信息的唯 一标识 列
            property：订单信息的唯 一标识 列所映射到Orders中哪个属性
          --><br>        <id column="id" property="id"><br>        <result column="user_id" property="userId"><br>        <result column="number" property="number"><br>        <result column="createtime" property="createtime"><br>        <result column="note" property="note"><br>        <!-- 配置映射的关联的用户信息 --><br>        <!-- association：用于映射关联查询单个对象的信息
        property：要将关联查询的用户信息映射到Orders中哪个属性
         --><br>        <association property="user" javatype="com.nuc.mybatis.po.User"><br>            <!-- id：关联查询用户的唯 一标识
            column：指定唯 一标识用户信息的列
            javaType：映射到user的哪个属性
             --><br>            <id column="user_id" property="id"><br>            <result column="username" property="username"><br>            <result column="sex" property="sex"><br>            <result column="address" property="address"><br>        </result></result></result></id></association><br>    </result></result></result></result></id></resultmap><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">&lt;!-- 查询订单关联查询用户信息，使用resultmap --&gt;</span><br><span class="line">    &lt;select id=&quot;findOrdersUserResultMap&quot; resultMap=&quot;OrdersUserResultMap&quot;&gt;</span><br><span class="line">        SELECT</span><br><span class="line">        orders.*,</span><br><span class="line">        USER.username,</span><br><span class="line">        USER.sex,</span><br><span class="line">        USER.address</span><br><span class="line">        FROM</span><br><span class="line">        orders,</span><br><span class="line">        USER</span><br><span class="line">        WHERE orders.user_id = user.id</span><br><span class="line">    &lt;/select&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>第四步</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//查询订单关联查询用户使用resultMap</span><br><span class="line">    public List&lt;Orders&gt; findOrdersUserResultMap()throws Exception;</span><br></pre></td></tr></table></figure></p>
<p><strong>测试</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void testFindOrdersResultMap() throws Exception &#123;</span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">    // 创建代理对象</span><br><span class="line">    OrdersMapperCustom ordersMapperCustom = sqlSession</span><br><span class="line">            .getMapper(OrdersMapperCustom.class);</span><br><span class="line">    // 调用maper的方法</span><br><span class="line">    List&lt;Orders&gt; list = ordersMapperCustom.findOrdersUserResultMap();</span><br><span class="line">    System.out.println(list);</span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>总结</strong></p>
<ul>
<li><p>resultType：使用resultType实现较为简单，如果pojo中没有包括查询出来的列名，需要增加列名对应的属性，即可完成映射。<strong>如果没有查询结果的特殊要求建议使用resultType。</strong></p>
</li>
<li><p>resultMap：需要单独定义resultMap，实现有点麻烦，如果对查询结果有特殊的要求，使用resultMap可以完成将关联查询映射pojo的属性中。<strong>resultMap可以实现延迟加载，resultType无法实现延迟加载。</strong></p>
</li>
</ul>
<ul>
<li><p>一对多 </p>
<ul>
<li><p>需求：查询订单及订单明细的信息。(根据数据库模型分析的结果来查询)</p>
<ul>
<li>使用resultMap：<br><img src="https://img-blog.csdn.net/20180429162309692?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><strong>要求：</strong>对orders映射不能出现重复记录。<br><strong>解决思路：</strong></li>
<li>在orders.java类中添加List&lt;&gt;,  orderDetails属性。</li>
<li>最终会将订单信息映射到orders中，订单所对应的订单明细映射到orders中的orderDetails属性中。</li>
<li>映射成的orders记录数为两条（orders信息不重复）</li>
<li>每个orders中的orderDetails属性存储了该 订单所对应的订单明细</li>
</ul>
<p>添加属性在之前已经实现，且注释。<br>只需要配置xml文件和接口，写一个测试类即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 订单及订单明细的resultMap</span><br><span class="line">	使用extends继承，不用在中配置订单信息和用户信息的映射</span><br><span class="line">	 --&gt;</span><br><span class="line">    &lt;resultMap type=&quot;com.nuc.mybatis.po.Orders&quot; id=&quot;OrdersAndOrderDetailResultMap&quot; extends=&quot;OrdersUserResultMap&quot;&gt;</span><br><span class="line">        &lt;!-- 订单信息 --&gt;</span><br><span class="line">        &lt;!-- 用户信息 --&gt;</span><br><span class="line">        &lt;!-- 使用extends继承，不用在中配置订单信息和用户信息的映射 --&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;!-- 订单明细信息</span><br><span class="line">        一个订单关联查询出了多条明细，要使用collection进行映射</span><br><span class="line">        collection：对关联查询到多条记录映射到集合对象中</span><br><span class="line">        property：将关联查询到多条记录映射到com.nuc.mybatis.po.Orders哪个属性</span><br><span class="line">        ofType：指定映射到list集合属性中pojo的类型</span><br><span class="line">         --&gt;</span><br><span class="line">        &lt;collection property=&quot;orderdetails&quot; ofType=&quot;com.nuc.mybatis.po.Orderdetail&quot;&gt;</span><br><span class="line">            &lt;!-- id：订单明细唯 一标识</span><br><span class="line">            property:要将订单明细的唯 一标识 映射到com.nuc.mybatis.po.Orderdetail的哪个属性</span><br><span class="line">              --&gt;</span><br><span class="line">            &lt;id column=&quot;orderdetail_id&quot; property=&quot;id&quot;/&gt;</span><br><span class="line">            &lt;result column=&quot;items_id&quot; property=&quot;itemsId&quot;/&gt;</span><br><span class="line">            &lt;result column=&quot;items_num&quot; property=&quot;itemsNum&quot;/&gt;</span><br><span class="line">            &lt;result column=&quot;orders_id&quot; property=&quot;ordersId&quot;/&gt;</span><br><span class="line">        &lt;/collection&gt;</span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line">    &lt;!-- 查询订单关联查询用户及订单明细，使用resultmap --&gt;</span><br><span class="line">    &lt;select id=&quot;findOrdersAndOrderDetailResultMap&quot; resultMap=&quot;OrdersAndOrderDetailResultMap&quot;&gt;</span><br><span class="line">        SELECT</span><br><span class="line">        orders.*,</span><br><span class="line">        USER.username,</span><br><span class="line">        USER.sex,</span><br><span class="line">        USER.address,</span><br><span class="line">        orderdetail.id orderdetail_id,</span><br><span class="line">        orderdetail.items_id,</span><br><span class="line">        orderdetail.items_num,</span><br><span class="line">        orderdetail.orders_id</span><br><span class="line">        FROM</span><br><span class="line">        orders,</span><br><span class="line">        USER,</span><br><span class="line">        orderdetail</span><br><span class="line">        WHERE orders.user_id = user.id AND orderdetail.orders_id=orders.id</span><br><span class="line">    &lt;/select&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> //查询订单(关联用户)及订单明细</span><br><span class="line">    public List&lt;Orders&gt; findOrdersAndOrderDetailResultMap() throws Exception;</span><br><span class="line">@Test</span><br><span class="line">    public void testfindOrdersAndOrderDetailResultMap() throws Exception &#123;</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">        // 创建代理对象</span><br><span class="line">        OrdersMapperCustom ordersMapperCustom = sqlSession</span><br><span class="line">                .getMapper(OrdersMapperCustom.class);</span><br><span class="line">        // 调用maper的方法</span><br><span class="line">        List&lt;Orders&gt; list = ordersMapperCustom.findOrdersAndOrderDetailResultMap();</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong></p>
<ul>
<li>mybatis使用resultMap的collection对关联查询的多条记录映射到一个list集合属性中。</li>
<li>使用resultType实现：将订单明细映射到orders中的orderdetails中，需要自己处理，使用双重循环遍历，去掉重复记录，将订单明细放在orderdetails中。</li>
<li>多对多<ul>
<li><strong>需求：</strong>查询用户及用户购买商品信息。</li>
<li>sql语句<ul>
<li>查询主表是：用户表</li>
<li>关联表：由于用户和商品没有直接关联，通过订单和订单明细进行关联，所以关联表：orders、orderdetail、items</li>
<li>SELECT<br>orders.*,<br>USER.username,<br>USER.sex,<br>USER.address,<br>orderdetail.id orderdetail_id,<br>orderdetail.items_id,<br>orderdetail.items_num,<br>orderdetail.orders_id,<br>items.name items_name,<br>items.detail items_detail,<br>items.price items_price<br>FROM<br>orders,<br>USER,<br>orderdetail,<br>items<br>WHERE orders.user_id = user.id AND orderdetail.orders_id=orders.id AND orderdetail.items_id = items.id</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>映射思路</p>
<ul>
<li>将用户信息映射到user中。</li>
<li>在user类中添加订单列表属性List<orders> orderslist，将用户创建的订单映射到orderslist</orders></li>
<li>在Orders中添加订单明细列表属性List&lt;&gt;orderdetials，将订单的明细映射到orderdetials</li>
<li>在OrderDetail中添加Items属性，将订单明细所对应的商品映射到Items</li>
</ul>
</li>
<li><p>mapper.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 查询用户及购买的商品信息，使用resultmap --&gt;</span><br><span class="line">&lt;select id=&quot;findUserAndItemsResultMap&quot; resultMap=&quot;UserAndItemsResultMap&quot;&gt;</span><br><span class="line">    SELECT</span><br><span class="line">    orders.*,</span><br><span class="line">    USER.username,</span><br><span class="line">    USER.sex,</span><br><span class="line">    USER.address,</span><br><span class="line">    orderdetail.id orderdetail_id,</span><br><span class="line">    orderdetail.items_id,</span><br><span class="line">    orderdetail.items_num,</span><br><span class="line">    orderdetail.orders_id,</span><br><span class="line">    items.name items_name,</span><br><span class="line">    items.detail items_detail,</span><br><span class="line">    items.price items_price</span><br><span class="line">    FROM</span><br><span class="line">    orders,</span><br><span class="line">    USER,</span><br><span class="line">    orderdetail,</span><br><span class="line">    items</span><br><span class="line">    WHERE orders.user_id = user.id AND orderdetail.orders_id=orders.id AND orderdetail.items_id = items.id</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>resultMap定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 查询用户及购买的商品 --&gt;</span><br><span class="line"> &lt;resultMap type=&quot;com.nuc.mybatis.po.User&quot; id=&quot;UserAndItemsResultMap&quot;&gt;</span><br><span class="line">     &lt;!-- 用户信息 --&gt;</span><br><span class="line">     &lt;id column=&quot;user_id&quot; property=&quot;id&quot;/&gt;</span><br><span class="line">     &lt;result column=&quot;username&quot; property=&quot;username&quot;/&gt;</span><br><span class="line">     &lt;result column=&quot;sex&quot; property=&quot;sex&quot;/&gt;</span><br><span class="line">     &lt;result column=&quot;address&quot; property=&quot;address&quot;/&gt;</span><br><span class="line"></span><br><span class="line">     &lt;!-- 订单信息</span><br><span class="line">     一个用户对应多个订单，使用collection映射</span><br><span class="line">      --&gt;</span><br><span class="line">     &lt;collection property=&quot;ordersList&quot; ofType=&quot;com.nuc.mybatis.po.Orders&quot;&gt;</span><br><span class="line">         &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;</span><br><span class="line">         &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;/&gt;</span><br><span class="line">         &lt;result column=&quot;number&quot; property=&quot;number&quot;/&gt;</span><br><span class="line">         &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;/&gt;</span><br><span class="line">         &lt;result column=&quot;note&quot; property=&quot;note&quot;/&gt;</span><br><span class="line"></span><br><span class="line">         &lt;!-- 订单明细</span><br><span class="line">     一个订单包括 多个明细</span><br><span class="line">      --&gt;</span><br><span class="line">         &lt;collection property=&quot;orderdetails&quot; ofType=&quot;com.nuc.mybatis.po.Orderdetail&quot;&gt;</span><br><span class="line">             &lt;id column=&quot;orderdetail_id&quot; property=&quot;id&quot;/&gt;</span><br><span class="line">             &lt;result column=&quot;items_id&quot; property=&quot;itemsId&quot;/&gt;</span><br><span class="line">             &lt;result column=&quot;items_num&quot; property=&quot;itemsNum&quot;/&gt;</span><br><span class="line">             &lt;result column=&quot;orders_id&quot; property=&quot;ordersId&quot;/&gt;</span><br><span class="line">             &lt;!-- 商品信息</span><br><span class="line">      一个订单明细对应一个商品</span><br><span class="line">       --&gt;</span><br><span class="line">             &lt;association property=&quot;items&quot; javaType=&quot;com.nuc.mybatis.po.Items&quot;&gt;</span><br><span class="line">                 &lt;id column=&quot;items_id&quot; property=&quot;id&quot;/&gt;</span><br><span class="line">                 &lt;result column=&quot;items_name&quot; property=&quot;name&quot;/&gt;</span><br><span class="line">                 &lt;result column=&quot;items_detail&quot; property=&quot;detail&quot;/&gt;</span><br><span class="line">                 &lt;result column=&quot;items_price&quot; property=&quot;price&quot;/&gt;</span><br><span class="line">             &lt;/association&gt;</span><br><span class="line">         &lt;/collection&gt;</span><br><span class="line">     &lt;/collection&gt;</span><br><span class="line"> &lt;/resultMap&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>mapper.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//查询用户购买商品信息</span><br><span class="line">   public List&lt;User&gt;  findUserAndItemsResultMap()throws Exception;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>测试</strong><br><img src="https://img-blog.csdn.net/20180429174426722?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p><strong>多对多查询总结</strong></p>
<ul>
<li>将查询用户购买的商品信息明细清单，（用户名、用户地址、购买商品名称、购买商品时间、购买商品数量）</li>
<li>针对上边的需求就使用resultType将查询到的记录映射到一个扩展的pojo中，很简单实现明细清单的功能。</li>
<li>一对多是多对多的特例，如下需求：<ul>
<li>查询用户购买的商品信息，用户和商品的关系是多对多关系。<ul>
<li>需求1：查询字段：用户账号、用户名称、用户性别、商品名称、商品价格(最常见)企业开发中常见明细列表，用户购买商品明细列表，使用resultType将上边查询列映射到pojo输出。</li>
<li>需求2：查询字段：用户账号、用户名称、购买商品数量、商品明细（鼠标移上显示明细）使用resultMap将用户购买的商品明细列表映射到user对象中。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>总结：<strong>使用resultMap是针对那些对查询结果映射有特殊要求的功能，比如特殊要求映射成list中包括 多个list</strong></p>
</li>
<li><strong>resultMap总结</strong><ul>
<li>resultType：<ul>
<li>作用:将查询结果按照sql列名pojo属性名一致性映射到pojo中。</li>
<li>场合：常见一些明细记录的展示，比如用户购买商品明细，将关联查询信息全部展示在页面时，此时可直接使用resultType将每一条记录映射到pojo中，在前端页面遍历list（list中是pojo）即可。</li>
</ul>
</li>
<li>resultMap：<ul>
<li>使用association和collection完成一对一和一对多高级映射（对结果有特殊的映射要求）。</li>
<li>association：<ul>
<li>作用：将关联查询信息映射到一个pojo对象中。</li>
<li>场合：为了方便查询关联信息可以使用association将关联订单信息映射为用户对象的pojo属性中，比如：查询订单及关联用户信息。</li>
<li><strong>使用resultType无法将查询结果映射到pojo对象的pojo属性中，根据对结果集查询遍历的需要选择使用resultType还是resultMap。</strong></li>
</ul>
</li>
<li>collection：<ul>
<li>作用：将关联查询信息映射到一个list集合中。</li>
<li>场合：为了方便查询遍历关联信息可以使用collection将关联信息映射到list集合中，比如：查询用户权限范围模块及模块下的菜单，可使用collection将模块映射到模块list中，将菜单列表映射到模块对象的菜单list属性中，这样的作的目的也是方便对查询结果集进行遍历查询。<strong>如果使用resultType无法将查询结果映射到list集合中。</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="10、Mybatis延迟加载"><a href="#10、Mybatis延迟加载" class="headerlink" title="10、Mybatis延迟加载"></a>10、Mybatis延迟加载</h2><ul>
<li><p>resultMap可以实现高级映射（使用association、collection实现一对一及一对多映射），association、collection具备延迟加载功能。</p>
<ul>
<li>需求：如果查询订单并且关联查询用户信息。如果先查询订单信息即可满足要求，当我们需要查询用户信息时再查询用户信息。把对用户信息的按需去查询就是延迟加载。</li>
</ul>
</li>
<li><p>延迟加载：先从单表查询、需要时再从关联表去关联查询，大大提高 数据库性能，因为查询单表要比关联查询多张表速度要快。</p>
</li>
<li><p>不使用mybatis提供的association及collection中的延迟加载功能，如何实现延迟加载？？</p>
<ul>
<li><p>实现方法如下：</p>
<ul>
<li>定义两个mapper方法：<ul>
<li>1、查询订单列表</li>
<li>2、根据用户id查询用户信息<ul>
<li>实现思路：先去查询第一个mapper方法，获取订单信息列表。在程序中（service），按需去调用第二个mapper方法去查询用户信息。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>总之：</strong>使用延迟加载方法，先去查询简单的sql（最好单表，也可以关联查询），再去按需要加载关联查询的其它信息。</p>
</li>
</ul>
</li>
</ul>
<h2 id="11、Mybatis查询缓存"><a href="#11、Mybatis查询缓存" class="headerlink" title="11、Mybatis查询缓存"></a>11、Mybatis查询缓存</h2><ul>
<li>什么是查询缓存？<ul>
<li>mybatis提供查询缓存，用于减轻数据压力，提高数据库性能。</li>
</ul>
</li>
<li>为什么要用缓存？<ul>
<li>如果缓存中有数据就不用从数据库中获取，大大提高系统性能。</li>
</ul>
</li>
<li>mybaits提供一级缓存，和二级缓存。<br><img src="https://img-blog.csdn.net/20180502105143436?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li><p>一级缓存</p>
<ul>
<li>一级缓存是SqlSession级别的缓存。在操作数据库时需要构造 sqlSession对象，在对象中有一个数据结构（HashMap）用于存储缓存数据。不同的sqlSession之间的缓存数据区域（HashMap）是互相不影响的。</li>
<li><p><strong>工作原理</strong><br><img src="https://img-blog.csdn.net/2018050210531373?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<ul>
<li>第一次发起查询用户id为1的用户信息，先去找缓存中是否有id为1的用户信息，如果没有，从数据库查询用户信息。得到用户信息，将用户信息存储到一级缓存中。</li>
<li>如果sqlSession去执行commit操作（执行插入、更新、删除），清空SqlSession中的一级缓存，这样做的目的为了让缓存中存储的是最新的信息，避免脏读。</li>
<li>第二次发起查询用户id为1的用户信息，先去找缓存中是否有id为1的用户信息，缓存中有，直接从缓存中获取用户信息。</li>
<li><p><strong>测试：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//mybatis默认支持一级缓存，不需要在配置文件去配置。</span><br><span class="line">    @Test</span><br><span class="line">    public void testCache1() throws Exception&#123;</span><br><span class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();//创建代理对象</span><br><span class="line">        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        //下边查询使用一个SqlSession</span><br><span class="line">        //第一次发起请求，查询id为1的用户</span><br><span class="line">        User user1 = userMapper.findUserById(1);</span><br><span class="line">        System.out.println(user1);</span><br><span class="line">//		如果sqlSession去执行commit操作（执行插入、更新、删除），清空SqlSession中的一级缓存，这样做的目的为了让缓存中存储的是最新的信息，避免脏读。</span><br><span class="line">        //更新user1的信息</span><br><span class="line">        user1.setUsername(&quot;测试用户22&quot;);</span><br><span class="line">        userMapper.updateUser(user1);</span><br><span class="line">        //执行commit操作去清空缓存</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        //第二次发起请求，查询id为1的用户</span><br><span class="line">        User user2 = userMapper.findUserById(1);</span><br><span class="line">        System.out.println(user2);</span><br><span class="line">        sqlSession.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>一级缓存应用</p>
<ul>
<li><p>正式开发，是将mybatis和spring进行整合开发，事务控制在service中。<br>一个service方法中包括 很多mapper方法调用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">service&#123;</span><br><span class="line">	//开始执行时，开启事务，创建SqlSession对象</span><br><span class="line">	//第一次调用mapper的方法findUserById(1)</span><br><span class="line">	</span><br><span class="line">	//第二次调用mapper的方法findUserById(1)，从一级缓存中取数据</span><br><span class="line">	//方法结束，sqlSession关闭</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>如果是执行两个service调用查询相同 的用户信息，不走一级缓存，因为session方法结束，sqlSession就关闭，一级缓存就清空。
</code></pre></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>二级缓存</p>
<ul>
<li>二级缓存是mapper级别的缓存，多个SqlSession去操作同一个Mapper的sql语句，多个SqlSession可以共用二级缓存，二级缓存是跨SqlSession的。</li>
<li>原理<br>  <img src="https://img-blog.csdn.net/20180502112111808?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><ul>
<li>首先开启mybatis的二级缓存。</li>
<li>sqlSession1去查询用户id为1的用户信息，查询到用户信息会将查询数据存储到二级缓存中。</li>
<li>如果SqlSession3去执行相同 mapper下sql，执行commit提交，清空该 mapper下的二级缓存区域的数据。</li>
<li>sqlSession2去查询用户id为1的用户信息，去缓存中找是否存在数据，如果存在直接从缓存中取出数据。</li>
<li>二级缓存与一级缓存区别，二级缓存的范围更大，多个sqlSession可以共享一个UserMapper的二级缓存区域。</li>
<li>UserMapper有一个二级缓存区域（按namespace分） ，其它mapper也有自己的二级缓存区域（按namespace分）。</li>
<li>每一个namespace的mapper都有一个二缓存区域，两个mapper的namespace如果相同，这两个mapper执行sql查询到数据将存在相同 的二级缓存区域中。</li>
</ul>
</li>
<li><strong>开启二级缓存：</strong><ul>
<li>mybaits的二级缓存是mapper范围级别，除了在SqlMapConfig.xml设置二级缓存的总开关，还要在具体的mapper.xml中开启二级缓存。<br><img src="https://img-blog.csdn.net/20180502115222752?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br><img src="https://img-blog.csdn.net/20180502115232686?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
<li>调用pojo类实现序列化接口<br><img src="https://img-blog.csdn.net/20180502115327122?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li>测试<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// 二级缓存测试</span><br><span class="line">  @Test</span><br><span class="line">  public void testCache2() throws Exception &#123;</span><br><span class="line">      SqlSession sqlSession1 = sqlSessionFactory.openSession();</span><br><span class="line">      SqlSession sqlSession2 = sqlSessionFactory.openSession();</span><br><span class="line">      SqlSession sqlSession3 = sqlSessionFactory.openSession();</span><br><span class="line">      // 创建代理对象</span><br><span class="line">      UserMapper userMapper1 = sqlSession1.getMapper(UserMapper.class);</span><br><span class="line">      // 第一次发起请求，查询id为1的用户</span><br><span class="line">      User user1 = userMapper1.findUserById(1);</span><br><span class="line">      System.out.println(user1);</span><br><span class="line">	</span><br><span class="line">      //这里执行关闭操作，将sqlsession中的数据写到二级缓存区域</span><br><span class="line">      sqlSession1.close();</span><br><span class="line">      </span><br><span class="line">      //使用sqlSession3执行commit()操作</span><br><span class="line">      UserMapper userMapper3 = sqlSession3.getMapper(UserMapper.class);</span><br><span class="line">      User user  = userMapper3.findUserById(1);</span><br><span class="line">      user.setUsername(&quot;张明明&quot;);</span><br><span class="line">      userMapper3.updateUser(user);</span><br><span class="line">      //执行提交，清空UserMapper下边的二级缓存</span><br><span class="line">      sqlSession3.commit();</span><br><span class="line">      sqlSession3.close();</span><br><span class="line">	</span><br><span class="line">      UserMapper userMapper2 = sqlSession2.getMapper(UserMapper.class);</span><br><span class="line">      // 第二次发起请求，查询id为1的用户</span><br><span class="line">      User user2 = userMapper2.findUserById(1);</span><br><span class="line">      System.out.println(user2);</span><br><span class="line">	</span><br><span class="line">      sqlSession2.close();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>useCache配置</p>
<ul>
<li><p>在statement中设置useCache=false可以禁用当前select语句的二级缓存，即每次查询都会发出sql去查询，默认情况是true，即该sql使用二级缓存。</p>
<figure class="highlight plain"><figcaption><span>id</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">	**总结：**针对每次查询都需要最新的数据sql，要设置成useCache=false，禁用二级缓存。</span><br><span class="line"></span><br><span class="line"> - 刷新缓存（就是清空缓存）</span><br><span class="line">	 - 在mapper的同一个namespace中，如果有其它insert、update、delete操作数据后需要刷新缓存，如果不执行刷新缓存会出现脏读。</span><br><span class="line">	 - 设置statement配置中的flushCache=&quot;true&quot; 属性，默认情况下为true即刷新缓存，如果改成false则不会刷新。使用缓存时如果手动修改数据库表中的查询数据会出现脏读。</span><br><span class="line">如下：</span><br><span class="line">```&lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot; flushCache=&quot;true&quot;&gt;</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong>一般下执行完commit操作都需要刷新缓存，flushCache=true表示刷新缓存，这样可以避免数据库脏读。</p>
</li>
</ul>
</li>
<li><p><strong>mybatis整合ehcache</strong></p>
<ul>
<li>ehcache是一个分布式缓存框架。</li>
<li>分布缓存<ul>
<li>我们系统为了提高系统并发，性能、一般对系统进行分布式部署（集群部署方式）<br><img src="https://img-blog.csdn.net/20180502131052785?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
</ul>
</li>
<li>不使用分布缓存，缓存的数据在各各服务单独存储，不方便系统 开发。所以要<strong>使用分布式缓存对缓存数据进行集中管理</strong></li>
<li><p>mybatis无法实现分布式缓存，需要和其它分布式缓存框架进行整合。</p>
<ul>
<li><p>整合方法（掌握）：</p>
<ul>
<li>mybatis提供了一个cache接口，如果要实现自己的缓存逻辑，实现cache接口开发即可。<strong>例如：</strong> mybatis和ehcache整合，mybatis和ehcache整合包中提供了一个cache接口的实现类。</li>
<li>加入ehcache包<br><img src="https://img-blog.csdn.net/20180502132013592?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>记得添加到class</li>
<li>配置mapper中cache中的type为ehcache对cache接口的实现类型。<br><img src="https://img-blog.csdn.net/20180502133031610?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></li>
<li><p>在config目录下加入ehcache的配置文件</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;ehcache xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:noNamespaceSchemaLocation=&quot;../config/ehcache.xsd&quot;&gt;</span><br><span class="line">    &lt;defaultCache</span><br><span class="line">            maxElementsInMemory=&quot;1000&quot;</span><br><span class="line">            maxElementsOnDisk=&quot;10000000&quot;</span><br><span class="line">            eternal=&quot;false&quot;</span><br><span class="line">            overflowToDisk=&quot;false&quot;</span><br><span class="line">            timeToIdleSeconds=&quot;120&quot;</span><br><span class="line">            timeToLiveSeconds=&quot;120&quot;</span><br><span class="line">            diskExpiryThreadIntervalSeconds=&quot;120&quot;</span><br><span class="line">            memoryStoreEvictionPolicy=&quot;LRU&quot;&gt;</span><br><span class="line">    &lt;/defaultCache&gt;</span><br><span class="line">&lt;/ehcache&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>二级缓存应用场景:</strong><br>  对于访问多的查询请求且用户对查询结果实时性要求不高，此时可采用mybatis二级缓存技术降低数据库访问量，提高访问速度，业务场景比如：耗时较高的统计分析sql、电话账单查询sql等。<br><strong>实现方法如下：</strong>通过设置刷新间隔时间，由mybatis每隔一段时间自动清空缓存，根据数据变化频率设置缓存刷新间隔flushInterval，比如设置为30分钟、60分钟、24小时等，根据需求而定。</li>
</ul>
<ul>
<li><strong>二级缓存局限性</strong><br> mybatis二级缓存对细粒度的数据级别的缓存实现不好，比如如下需求：对商品信息进行缓存，由于商品信息查询访问量大，但是要求用户每次都能查询最新的商品信息，此时如果使用mybatis的二级缓存就无法实现当一个商品变化时只刷新该商品的缓存信息而不刷新其它商品的信息，因为mybaits的二级缓存区域以mapper为单位划分，当一个商品信息变化会将所有商品信息的缓存数据全部清空。解决此类问题需要在业务层根据需求对数据有针对性缓存。</li>
</ul>
<h2 id="12、Mybatis和Spring整合-掌握"><a href="#12、Mybatis和Spring整合-掌握" class="headerlink" title="12、Mybatis和Spring整合(掌握)"></a>12、Mybatis和Spring整合(掌握)</h2><ul>
<li><strong>整合思路</strong><ul>
<li>需要spring通过单例方式管理SqlSessionFactory。</li>
<li>spring和mybatis整合生成代理对象，使用SqlSessionFactory创建SqlSession。（spring和mybatis整合自动完成）</li>
<li>持久层的mapper都需要由spring进行管理。</li>
</ul>
</li>
<li><strong>整合环境</strong><ul>
<li>创建一个新的java工程（接近实际开发的工程结构）</li>
<li>jar包：<ul>
<li>mybatis3.2.7的jar包</li>
<li>spring3.2.0的jar包</li>
<li>mybatis和spring的整合包：早期ibatis和spring整合是由spring官方提供，mybatis和spring整合由mybatis提供。<br><img src="https://img-blog.csdn.net/20180502165235383?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"><br>项目源码见链接: <a href="https://pan.baidu.com/s/1yos2TcC_TRCPWUJ_-Wnd3Q" target="_blank" rel="noopener">密码: vcae</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="13、Mybatis逆向工程"><a href="#13、Mybatis逆向工程" class="headerlink" title="13、Mybatis逆向工程"></a>13、Mybatis逆向工程</h2><ul>
<li>什么是逆向工程<ul>
<li>mybaits需要程序员自己编写sql语句，mybatis官方提供逆向工程 可以针对单表自动生成mybatis执行所需要的代码（mapper.java,mapper.xml、po..）</li>
<li>企业实际开发中，常用的逆向工程方式：由于数据库的表生成java代码。</li>
</ul>
</li>
</ul>
<p>mybatis的项目源码<a href="https://pan.baidu.com/s/1_7726eiziGRnzX1sAIOMWQ" target="_blank" rel="noopener">密码: b54x</a><br>mybatis的文档教程<a href="https://pan.baidu.com/s/1kDKJTw5TEFoXm4LrEIn02g" target="_blank" rel="noopener">密码: pbvf</a><br>mybatis+springMVC的视频教程<a href="http://www.icoolxue.com/album/show/216" target="_blank" rel="noopener">mybatis+springMVC</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Mybatis/" rel="tag"># Mybatis</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/04/10/springmvc/" rel="next" title="SpringMVC学习笔记🍂">
                <i class="fa fa-chevron-left"></i> SpringMVC学习笔记🍂
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="http://www.qqzhi.com/uploadpic/2014-05-04/034226102.jpg"
                alt="EasyChill" />
            
              <p class="site-author-name" itemprop="name">EasyChill</p>
              <p class="site-description motion-element" itemprop="description">这里是我的博客以及生活总结</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/24bc1eb70081" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-book"></i>简书</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/mrsongjiangtao" target="_blank" title="Github">
                      
                        <i class="fa fa-fw fa-github"></i>Github</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://img-blog.csdn.net/20180922081342916?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NvbmdfSmlhbmdUYW8=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" target="_blank" title="QQ">
                      
                        <i class="fa fa-fw fa-qq"></i>QQ</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://music.163.com/#/user/home?id=378985282" target="_blank" title="网易云">
                      
                        <i class="fa fa-fw fa-music"></i>网易云</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、对原生态jdbc程序（单独使用jdbc开发）问题总结"><span class="nav-number">1.</span> <span class="nav-text">1、对原生态jdbc程序（单独使用jdbc开发）问题总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、Mybatis框架原理-掌握"><span class="nav-number">2.</span> <span class="nav-text">2、Mybatis框架原理(掌握)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、Mybatis入门程序"><span class="nav-number">3.</span> <span class="nav-text">3、Mybatis入门程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、Mybatis开发dao的方法"><span class="nav-number">4.</span> <span class="nav-text">4、Mybatis开发dao的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、Mybatis配置文件SqlMapConfig-xml"><span class="nav-number">5.</span> <span class="nav-text">5、Mybatis配置文件SqlMapConfig.xml</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、Mybatis核心"><span class="nav-number">6.</span> <span class="nav-text">6、Mybatis核心</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、Mybatis的动态sql-掌握"><span class="nav-number">7.</span> <span class="nav-text">7、Mybatis的动态sql(掌握)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10、Mybatis延迟加载"><span class="nav-number">8.</span> <span class="nav-text">10、Mybatis延迟加载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11、Mybatis查询缓存"><span class="nav-number">9.</span> <span class="nav-text">11、Mybatis查询缓存</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12、Mybatis和Spring整合-掌握"><span class="nav-number">10.</span> <span class="nav-text">12、Mybatis和Spring整合(掌握)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13、Mybatis逆向工程"><span class="nav-number">11.</span> <span class="nav-text">13、Mybatis逆向工程</span></a></li></ol></div>
            
            <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=447076485&auto=1&height=66"></iframe>
          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">EasyChill</span>

  
</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
